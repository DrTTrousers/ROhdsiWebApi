
# Copyright 2020 Observational Health Data Sciences and Informatics
#
# This file is part of FeatureExtraction
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


# This file has been autogenerated. Do not change by hand.




baseUrl <- Sys.getenv("ohdsiBaseUrl")


### Testing functions in WebApi.R

testthat::test_that(desc = "Test .isValidUrl", code = {
  blackhole <- ROhdsiWebApi:::.isValidUrl(urlToCheck = "http://black_hole.net")
  ohdsi <- ROhdsiWebApi:::.isValidUrl(urlToCheck = "https://ohdsi.org/")
  testthat::expect_type(object = blackhole, type = 'logical')
  testthat::expect_type(object = ohdsi, type = 'logical')
  testthat::expect_setequal(object = c(blackhole, ohdsi), expected = c(FALSE, TRUE))
})

testthat::test_that(desc = "Test .checkBaseUrl", code = {
  testthat::skip_if(baseUrl == "")
  value <- ROhdsiWebApi:::.checkBaseUrl(baseUrl = baseUrl)
  testthat::expect_null(value)
})

testthat::test_that(desc = "Test getPriorityVocabulary", code = {
  testthat::skip_if(baseUrl == "")
  value <- ROhdsiWebApi::getPriorityVocabularyKey(baseUrl = baseUrl)
  testthat::expect_type(object = value, type = 'character')
})

testthat::test_that(desc = "Test getWebApiVersion", code = {
  testthat::skip_if(baseUrl == "")
  value <- ROhdsiWebApi::getWebApiVersion(baseUrl = baseUrl)
  testthat::expect_type(object = value, type = 'character')
})

test_that(desc = "Test getCdmSources", code = {
  testthat::skip_if(baseUrl == "")
  cdmSources <- ROhdsiWebApi::getCdmSources(baseUrl = baseUrl)
  testthat::expect_s3_class(object = cdmSources, class = "data.frame")
  testthat::expect_gt(object = nrow(cdmSources), expected = 0)
})

test_that(desc = "Test isValidSourceKey", code = {
  testthat::skip_if(baseUrl == "")
  isValid <- ROhdsiWebApi::isValidSourceKey(baseUrl = baseUrl, sourceKeys = 'SYNPUF1K')
  testthat::expect_type(object = isValid, type = 'logical')
  testthat::expect_equal(object = isValid, expected = TRUE)
})

test_that(desc = "Test .getStandardCategories", code = {
  standardCategories <- ROhdsiWebApi:::.getStandardCategories() %>% dplyr::arrange() %>% dplyr::pull(categoryStandard)
  testthat::expect_setequal(object = standardCategories, expected = c("conceptSet","cohort","incidenceRate","estimation", "prediction","characterization","pathway"))
})

testthat::test_that(desc = "Test getDefinitionsMetadata", code = {
  testthat::skip_if(baseUrl == "")
  value <- ROhdsiWebApi::getDefinitionsMetadata(baseUrl = baseUrl, category = 'cohort')
  testthat::expect_s3_class(object = value, class = "tbl")
  testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
})

test_that(desc = "Test isValidId", code = {
  testthat::skip_if(baseUrl == "")
  validId <- ROhdsiWebApi::isValidId(baseUrl = baseUrl, ids = c(0,-1), category = 'cohort')
  testthat::expect_type(object = validId, type = 'logical')
  testthat::expect_setequal(object = validId, expected = c(FALSE, FALSE))
})


  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getConceptSetDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getConceptSetDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidConceptSetId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidConceptSetId(baseUrl = baseUrl, conceptSetIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })

  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getCohortDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getCohortDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidCohortId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidCohortId(baseUrl = baseUrl, cohortIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })

  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getIncidenceRateDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getIncidenceRateDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidIncidenceRateId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidIncidenceRateId(baseUrl = baseUrl, incidenceRateIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })

  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getEstimationDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getEstimationDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidEstimationId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidEstimationId(baseUrl = baseUrl, estimationIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })

  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getPredictionDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getPredictionDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidPredictionId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidPredictionId(baseUrl = baseUrl, predictionIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })

  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getCharacterizationDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getCharacterizationDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidCharacterizationId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidCharacterizationId(baseUrl = baseUrl, characterizationIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })

  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test getPathwayDefinitionsMetaData", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::getPathwayDefinitionsMetaData(baseUrl = baseUrl)
    testthat::expect_s3_class(object = value, class = "tbl")
    testthat::expect_s3_class(object = value$createdDate, class = "POSIXct")
  })
  
  ### autogenerated code - do not edit by hand
  testthat::test_that(desc = "Test isValidPathwayId", code = {
    testthat::skip_if(baseUrl == "")
    value <- ROhdsiWebApi::isValidPathwayId(baseUrl = baseUrl, pathwayIds = c(0,-1))
    testthat::expect_type(object = value, type = "logical")
    testthat::expect_setequal(object = value, expected = c(FALSE, FALSE))
  })
