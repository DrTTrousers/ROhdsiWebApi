# Copyright 2020 Observational Health Data Sciences and Informatics
#
# This file is part of FeatureExtraction
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.


# This file has been autogenerated. Do not change by hand.




#' Retrieve the meta data for ConceptSet definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for ConceptSet. This function is useful to retrieve the current ConceptSet
#' specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for ConceptSet. Note: modifiedDate and createdDate are returned
#' as text/character.
#'
#' @examples
#' \dontrun{
#' getConceptSetDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getConceptSetDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("conceptSet")))
}


#' Check if ConceptSet id is valid.
#'
#' @details
#' Checks if a set of id for a ConceptSet is valid, i.e. checks if all the ids exists in the WebApi
#' i.e. valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the ConceptSet to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidConceptSetId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidConceptSetId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "conceptSet")
  return(ids %in% validIds$id)
}




#' Get ConceptSet id definition.
#'
#' @details
#' Obtain the ConceptSet definition from WebAPI for a given ConceptSet id
#'
#' @template BaseUrl
#' @param ConceptSetId   An integer id representing the id that uniquely identifies a ConceptSet
#'                       definition in a WebApi instance.
#' @return
#' An R object representing the ConceptSet definition
#'
#' @examples
#' \dontrun{
#' getConceptSetDefinition(ConceptSetId = 13242, baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getConceptSetDefinition <- function(conceptSetId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(conceptSetId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidConceptSetId(ids = conceptSetId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "conceptset", "/", conceptSetId)
    if ("characterization" == "conceptSet") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("ConceptSetId : conceptSetId is not present in the WebApi.")
  }
}


#' Retrieve the meta data for Cohort definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for Cohort. This function is useful to retrieve the current Cohort
#' specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for Cohort. Note: modifiedDate and createdDate are returned as
#' text/character.
#'
#' @examples
#' \dontrun{
#' getCohortDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getCohortDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("cohort")))
}


#' Check if Cohort id is valid.
#'
#' @details
#' Checks if a set of id for a Cohort is valid, i.e. checks if all the ids exists in the WebApi i.e.
#' valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the Cohort to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidCohortId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidCohortId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "cohort")
  return(ids %in% validIds$id)
}




#' Get Cohort id definition.
#'
#' @details
#' Obtain the Cohort definition from WebAPI for a given Cohort id
#'
#' @template BaseUrl
#' @param CohortId   An integer id representing the id that uniquely identifies a Cohort definition in
#'                   a WebApi instance.
#' @return
#' An R object representing the Cohort definition
#'
#' @examples
#' \dontrun{
#' getCohortDefinition(CohortId = 13242, baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getCohortDefinition <- function(cohortId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(cohortId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidCohortId(ids = cohortId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "cohortdefinition", "/", cohortId)
    if ("characterization" == "cohort") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("CohortId : cohortId is not present in the WebApi.")
  }
}


#' Retrieve the meta data for IncidenceRate definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for IncidenceRate. This function is useful to retrieve the current
#' IncidenceRate specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for IncidenceRate. Note: modifiedDate and createdDate are
#' returned as text/character.
#'
#' @examples
#' \dontrun{
#' getIncidenceRateDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getIncidenceRateDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("incidenceRate")))
}


#' Check if IncidenceRate id is valid.
#'
#' @details
#' Checks if a set of id for a IncidenceRate is valid, i.e. checks if all the ids exists in the WebApi
#' i.e. valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the IncidenceRate to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidIncidenceRateId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidIncidenceRateId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "incidenceRate")
  return(ids %in% validIds$id)
}




#' Get IncidenceRate id definition.
#'
#' @details
#' Obtain the IncidenceRate definition from WebAPI for a given IncidenceRate id
#'
#' @template BaseUrl
#' @param IncidenceRateId   An integer id representing the id that uniquely identifies a IncidenceRate
#'                          definition in a WebApi instance.
#' @return
#' An R object representing the IncidenceRate definition
#'
#' @examples
#' \dontrun{
#' getIncidenceRateDefinition(IncidenceRateId = 13242, baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getIncidenceRateDefinition <- function(incidenceRateId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(incidenceRateId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidIncidenceRateId(ids = incidenceRateId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "ir", "/", incidenceRateId)
    if ("characterization" == "incidenceRate") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("IncidenceRateId : incidenceRateId is not present in the WebApi.")
  }
}


#' Retrieve the meta data for Estimation definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for Estimation. This function is useful to retrieve the current Estimation
#' specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for Estimation. Note: modifiedDate and createdDate are returned
#' as text/character.
#'
#' @examples
#' \dontrun{
#' getEstimationDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getEstimationDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("estimation")))
}


#' Check if Estimation id is valid.
#'
#' @details
#' Checks if a set of id for a Estimation is valid, i.e. checks if all the ids exists in the WebApi
#' i.e. valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the Estimation to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidEstimationId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidEstimationId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "estimation")
  return(ids %in% validIds$id)
}




#' Get Estimation id definition.
#'
#' @details
#' Obtain the Estimation definition from WebAPI for a given Estimation id
#'
#' @template BaseUrl
#' @param EstimationId   An integer id representing the id that uniquely identifies a Estimation
#'                       definition in a WebApi instance.
#' @return
#' An R object representing the Estimation definition
#'
#' @examples
#' \dontrun{
#' getEstimationDefinition(EstimationId = 13242, baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getEstimationDefinition <- function(estimationId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(estimationId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidEstimationId(ids = estimationId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "estimation", "/", estimationId)
    if ("characterization" == "estimation") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("EstimationId : estimationId is not present in the WebApi.")
  }
}


#' Retrieve the meta data for Prediction definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for Prediction. This function is useful to retrieve the current Prediction
#' specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for Prediction. Note: modifiedDate and createdDate are returned
#' as text/character.
#'
#' @examples
#' \dontrun{
#' getPredictionDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getPredictionDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("prediction")))
}


#' Check if Prediction id is valid.
#'
#' @details
#' Checks if a set of id for a Prediction is valid, i.e. checks if all the ids exists in the WebApi
#' i.e. valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the Prediction to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidPredictionId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidPredictionId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "prediction")
  return(ids %in% validIds$id)
}




#' Get Prediction id definition.
#'
#' @details
#' Obtain the Prediction definition from WebAPI for a given Prediction id
#'
#' @template BaseUrl
#' @param PredictionId   An integer id representing the id that uniquely identifies a Prediction
#'                       definition in a WebApi instance.
#' @return
#' An R object representing the Prediction definition
#'
#' @examples
#' \dontrun{
#' getPredictionDefinition(PredictionId = 13242, baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getPredictionDefinition <- function(predictionId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(predictionId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidPredictionId(ids = predictionId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "prediction", "/", predictionId)
    if ("characterization" == "prediction") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("PredictionId : predictionId is not present in the WebApi.")
  }
}


#' Retrieve the meta data for Characterization definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for Characterization. This function is useful to retrieve the current
#' Characterization specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for Characterization. Note: modifiedDate and createdDate are
#' returned as text/character.
#'
#' @examples
#' \dontrun{
#' getCharacterizationDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getCharacterizationDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("characterization")))
}


#' Check if Characterization id is valid.
#'
#' @details
#' Checks if a set of id for a Characterization is valid, i.e. checks if all the ids exists in the
#' WebApi i.e. valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the Characterization to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidCharacterizationId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidCharacterizationId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "characterization")
  return(ids %in% validIds$id)
}




#' Get Characterization id definition.
#'
#' @details
#' Obtain the Characterization definition from WebAPI for a given Characterization id
#'
#' @template BaseUrl
#' @param CharacterizationId   An integer id representing the id that uniquely identifies a
#'                             Characterization definition in a WebApi instance.
#' @return
#' An R object representing the Characterization definition
#'
#' @examples
#' \dontrun{
#' getCharacterizationDefinition(CharacterizationId = 13242,
#'                               baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getCharacterizationDefinition <- function(characterizationId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(characterizationId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidCharacterizationId(ids = characterizationId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "cohort-characterization", "/", characterizationId)
    if ("characterization" == "characterization") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("CharacterizationId : characterizationId is not present in the WebApi.")
  }
}


#' Retrieve the meta data for Pathway definitions.
#'
#' @details
#' Obtains the meta data of WebApi specifications such as id, name, created/modified details, hash
#' object, etc. from WebApi for Pathway. This function is useful to retrieve the current Pathway
#' specifications.
#'
#' @template BaseUrl
#' @return
#' A tibble of specification metadata for Pathway. Note: modifiedDate and createdDate are returned as
#' text/character.
#'
#' @examples
#' \dontrun{
#' getPathwayDefinitionsMetaData(baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getPathwayDefinitionsMetaData <- function(baseUrl) {
  .checkBaseUrl(baseUrl)
  return(getDefinitionsMetadata(baseUrl = baseUrl, categories = c("pathway")))
}


#' Check if Pathway id is valid.
#'
#' @details
#' Checks if a set of id for a Pathway is valid, i.e. checks if all the ids exists in the WebApi i.e.
#' valid.
#'
#' @template BaseUrl
#' @param    ids   A list of integer id(s) of the Pathway to be tested for validity.
#' @return
#' A logical vector indicating which of the ids are valid.
#'
#' @examples
#' \dontrun{
#' isValidPathwayId(ids = c(13242, 3423, 34), baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
isValidPathwayId <- function(ids, baseUrl) {
  .checkBaseUrl(baseUrl)

  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertIntegerish(ids, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  validIds <- getDefinitionsMetadata(baseUrl = baseUrl, categories = "pathway")
  return(ids %in% validIds$id)
}




#' Get Pathway id definition.
#'
#' @details
#' Obtain the Pathway definition from WebAPI for a given Pathway id
#'
#' @template BaseUrl
#' @param PathwayId   An integer id representing the id that uniquely identifies a Pathway definition
#'                    in a WebApi instance.
#' @return
#' An R object representing the Pathway definition
#'
#' @examples
#' \dontrun{
#' getPathwayDefinition(PathwayId = 13242, baseUrl = "http://server.org:80/WebAPI")
#' }
#' @export
getPathwayDefinition <- function(pathwayId, baseUrl) {
  .checkBaseUrl(baseUrl)
  errorMessage <- checkmate::makeAssertCollection()
  checkmate::assertInt(pathwayId, add = errorMessage)
  checkmate::reportAssertions(errorMessage)

  if (isTRUE(isValidPathwayId(ids = pathwayId, baseUrl = baseUrl))) {
    url <- paste0(baseUrl, "/", "pathway-analysis", "/", pathwayId)
    if ("characterization" == "pathway") {
      url <- paste0(url, "/export")
    }
    metaData <- httr::GET(url)
    metaData <- httr::content(metaData)
    if (!is.null(metaData$payload$message)) {
      stop(metaData$payload$message)
    }

    if (is.null(metaData$expression)) {
      if (!is.null(metaData$specification)) {
        metaData$expression <- metaData$specification
        metaData$specification <- NULL
      } else {
        url <- paste0(url, "/expression")
        data <- httr::GET(url)
        data <- httr::content(data)
        metaData$expression <- data
      }
    }
    return(metaData)
  } else {
    stop("PathwayId : pathwayId is not present in the WebApi.")
  }
}
